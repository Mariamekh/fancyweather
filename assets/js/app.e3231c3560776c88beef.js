!function(e){function t(t){for(var r,o,u=t[0],c=t[1],s=t[2],h=0,d=[];h<u.length;h++)o=u[h],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,u=1;u<n.length;u++){var c=n[u];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var l=c;i.push([102,2]),n()}({101:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));n(55),n(65),n(67),n(68),n(51),n(73),n(116),n(78),n(82),n(118),n(83),n(119),n(120),n(121),n(90),n(53),n(94),n(95),n(129),n(130),n(131),n(133),n(134);var r=n(25),a=n.n(r);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}a.a.accessToken="pk.eyJ1IjoiZ2lnZ2xlbW9vbiIsImEiOiJja2oxdHd6bGMwbXJrMnRwOGNycmJ5M3p1In0.aLX7_8ebaAFPS1S_0j70bA";var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=null,this.mapMarker=null,this.mapInit(t,n)}var t,n,r;return t=e,(n=[{key:"mapInit",value:function(e,t){return this.map=new a.a.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[t,e],zoom:9}),this.mapMarker=new a.a.Marker({color:"red",draggable:!0}).setLngLat([t,e]).setPopup(new a.a.Popup({closeOnMove:!0})).addTo(this.map),this.bind(),this.map}},{key:"bind",value:function(){var e=this;this.mapMarker.on("dragend",(function(){var t=e.mapMarker.getLngLat();e.onMapSearch([t.lat,t.lng])}))}},{key:"onMapSearch",value:function(){throw new Error("try again",this)}},{key:"moveMapCenter",value:function(e,t){this.map.jumpTo({center:[t,e]}),this.mapMarker.setLngLat([t,e])}}])&&i(t.prototype,n),r&&i(t,r),e}();window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;var u=new window.SpeechRecognition;u.interimResults=!0;var c=u;function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=32,m=1.8,y=["EN","RU","GE"],p=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formatSettings=n,this.mapElem=new o(t.location.latitude,t.location.longitude),this.langItemClickHandler=this.langItemClickHandler.bind(this),this.speechResultHandler=this.speechResultHandler.bind(this),this.init(t)}var t,n,r;return t=e,r=[{key:"dispatchSearch",value:function(){var e=document.querySelector(".search-form"),t=new Event("submit");e.dispatchEvent(t)}},{key:"isTargetInputChecked",value:function(e){var t=e.getAttribute("for");return document.querySelector("#".concat(t)).checked}},{key:"getValueFromCheckedInput",value:function(){return!0===document.querySelector("#options-units-degrees").checked?"phar":"deg"}},{key:"switchLang",value:function(e){var t=document.querySelector(".lang-option-list");document.querySelector(".lang-switcher").querySelector(".lang-menu").innerText=e,t.innerHTML="\n      ".concat(y.filter((function(t){return t!==e})).map((function(e){return function(e){return'<li><a class="lang-option" href="#">'.concat(e,"</a></li>")}(e)})).join(""))}},{key:"showErrorMessage",value:function(e){var t=document.querySelector(".error-message"),n=document.querySelector(".search-input");t.querySelector(".error-text").innerText="".concat(e),t.classList.add("active"),document.body.addEventListener("mouseup",(function e(r){t.classList.remove("active"),document.body.removeEventListener("mouseup",e),r.target.closest(".swiper-container")||r.target.closest(".list-container")||n.focus()})),n.addEventListener("input",(function e(){t.classList.remove("active"),n.removeEventListener("input",e)})),n.focus()}},{key:"findPageElements",value:function(){var e=document.querySelector(".weather-performance");return{tempValueElem:e.querySelector(".value"),weatherStateElem:e.querySelector(".weather-state"),weatherFeelingElem:e.querySelector(".weather-feeling .value"),weatherWindElem:e.querySelector(".weather-wind .value"),weatherHumidityElem:e.querySelector(".weather-humidity .value"),weatherPictureElem:e.querySelector(".current-weather-image"),latitudeElem:document.querySelector(".latitude-value"),longitudeElem:document.querySelector(".longitude-value"),locationElem:document.querySelector(".location-name"),dateElem:document.querySelector(".date-item.date"),timeElem:document.querySelector(".date-item.time"),forecastElemList:document.querySelectorAll(".forecast-value"),forecastIconsList:document.querySelectorAll(".day-temperature-icon")}}},{key:"updateBgPicture",value:function(e){var t=document.querySelector(".body-background img");e&&t.replaceWith(e)}},{key:"formatCoord",value:function(e){var t=s(e.split("."),2),n=t[0],r=t[1];return"".concat(n,"°").concat(r,"'")}},{key:"convertPharIntoDeg",value:function(e){return((e-g)/m).toFixed(0)}},{key:"convertDegIntoPhar",value:function(e){return(e*m+g).toFixed(0)}}],(n=[{key:"init",value:function(e){this.pageElements=this.constructor.findPageElements(),this.renderPageContent(e,this.formatSettings),this.bind()}},{key:"bind",value:function(){var e=document.querySelector(".search-form"),t=document.querySelector(".microphone-btn"),n=document.querySelector(".update-bg-btn");this.langDropdown=document.querySelector(".lang-switcher");var r=document.querySelector(".units-switcher");e.addEventListener("submit",this.formSubmitHandler.bind(this)),n.addEventListener("click",this.updateBgBtnHandler.bind(this)),this.langDropdown.addEventListener("click",this.langDropdownHandler.bind(this)),r.addEventListener("mouseup",this.tempUnitsChangeHandler.bind(this)),t.addEventListener("click",this.startRecognizing.bind(this))}},{key:"startRecognizing",value:function(){var e=document.querySelector(".microphone-btn");e.classList.contains("active")?this.stopMicrophone():(c.addEventListener("result",this.speechResultHandler),c.start(),e.classList.add("active"))}},{key:"speechResultHandler",value:function(e){if(e.results[0].isFinal){var t=e.results[0][0].transcript;document.querySelector(".search-input").value=t,this.constructor.dispatchSearch(),this.stopMicrophone(),c.removeEventListener("result",this.speechResultHandler)}}},{key:"stopMicrophone",value:function(){c.stop(),document.querySelector(".microphone-btn").classList.remove("active"),c.removeEventListener("result",this.speechResultHandler)}},{key:"formSubmitHandler",value:function(e){e.preventDefault();var t=document.querySelector(".search-input").value;this.onUserSearch(t)}},{key:"updateBgBtnHandler",value:function(){this.onBgUpdate()}},{key:"tempUnitsChangeHandler",value:function(e){if(!e.target.closest(".units-label")||!this.constructor.isTargetInputChecked(e.target)){var t=this.constructor.getValueFromCheckedInput();this.onTempUnitsChange(t),this.switchPageTempUnits(t,"userClick")}}},{key:"switchPageTempUnits",value:function(e,t){var n=this;if("deg"!==e||t){var r=document.querySelector(".current-weather .value"),a=document.querySelector(".current-weather-unit");this.changeUnitsValue(r,a,e);var i=document.querySelector(".weather-feeling .value"),o=document.querySelector(".feeling-weather-unit");this.changeUnitsValue(i,o,e),l(document.querySelectorAll(".forecast-value")).forEach((function(t){var r=t.nextElementSibling;n.changeUnitsValue(t,r,e)}))}}},{key:"changeUnitsValue",value:function(e,t,n){var r=e,a=t;r.innerText="deg"===n?this.constructor.convertPharIntoDeg(r.innerText):this.constructor.convertDegIntoPhar(r.innerText),a.innerText=a.innerText="deg"===n?"°C":"°F"}},{key:"langDropdownHandler",value:function(e){e.target.classList.contains("lang-menu")&&e.target.closest(".active")?this.langDropdown.classList.remove("active"):(this.langDropdown.classList.add("active"),document.body.addEventListener("mouseup",this.langItemClickHandler))}},{key:"langItemClickHandler",value:function(e){if(e.target.classList.contains("lang-option")){var t=e.target.innerText;this.constructor.switchLang(t)}e.target.classList.contains("lang-menu")||this.langDropdown.classList.remove("active"),document.body.removeEventListener("mouseup",this.langItemClickHandler)}},{key:"updatePageOnSearch",value:function(e,t){this.moveMapCenter(e.location.latitude,e.location.longitude),this.renderPageContent(e,t)}},{key:"moveMapCenter",value:function(e,t){this.mapElem.map.jumpTo({center:[t,e]}),this.mapElem.mapMarker.setLngLat([t,e])}},{key:"onUserSearch",value:function(){throw new Error("method should be overriden",this)}},{key:"onBgUpdate",value:function(){throw new Error("method should be overriden",this)}},{key:"onLangChoice",value:function(){throw new Error("method should be overriden",this)}},{key:"onTempUnitsChange",value:function(){throw new Error("method should be overriden",this)}},{key:"renderPageContent",value:function(e){this.constructor.updateBgPicture(e.pictureElem),this.renderCoordsInfo(e.location.latitude,e.location.longitude),this.renderLocation(e.location.city,e.location.countryName),this.renderDate(e.location.timeZone),this.renderCurrentTemp(e.weather.current),this.renderForecastTemp(e.weather.forecast)}},{key:"renderOptions",value:function(e){this.constructor.switchLang(e.language);for(var t=document.querySelectorAll(".units-switcher input"),n=0;n<t.length;n+=1)if(t[n].dataset.val===e.tempUnits)return void(t[n].checked=!0)}},{key:"renderCoordsInfo",value:function(e,t){var n=this.constructor.formatCoord(Number(e).toFixed(2)),r=this.constructor.formatCoord(Number(t).toFixed(2));this.pageElements.latitudeElem.innerText=n,this.pageElements.longitudeElem.innerText=r}},{key:"renderLocation",value:function(e,t){this.pageElements.locationElem.innerHTML="".concat(e,", ").concat(t)}},{key:"renderDate",value:function(e){this.renderDay(e),this.renderTime(e)}},{key:"renderDay",value:function(e){var t=this.pageElements.dateElem,n=(new Date).toLocaleString("en-GB",{hour12:!1,timeZone:e.name,weekday:"short",month:"long",day:"numeric"}).replace(/,/g,"");t.innerText=n}},{key:"renderTime",value:function(e){var t=this.pageElements.timeElem,n=(new Date).toLocaleString("en-GB",{hour12:!1,timeZone:e.name,hour:"2-digit",minute:"2-digit",second:"2-digit"});t.innerText=n}},{key:"renderCurrentTemp",value:function(e){this.pageElements.tempValueElem.innerText=Number(e.temp).toFixed(),this.pageElements.weatherStateElem.innerText=e.descr,this.pageElements.weatherFeelingElem.innerText=Number(e.feltTemp).toFixed(),this.pageElements.weatherWindElem.innerText=Number(e.wind).toFixed(),this.pageElements.weatherHumidityElem.innerText=Number(e.humidity),this.pageElements.weatherPictureElem.innerHTML=e.icon}},{key:"renderForecastTemp",value:function(e){var t=this.pageElements,n=t.forecastElemList,r=t.forecastIconsList;n.forEach((function(t,n){t.innerText=e[n].temp})),r.forEach((function(t,n){t.innerHTML=e[n].icon}))}}])&&f(t.prototype,n),r&&f(t,r),e}(),v='<svg class="icon" viewbox="0 0 100 100">\n                  <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradGray)"/>\n                  <use xlink:href="#grayCloud" x="25" y="10" class="reverse-small-cloud" fill="url(#gradDarkGray)"/>\n                  <use xlink:href="#thunderBolt" x="30" y="61" class="lighting animated infinite flash"/>\n                  <use xlink:href="#whiteCloud" x="7" />\n                  <use xlink:href="#thunderBolt" x="45" y="56" class="lighting animated infinite flash delay-1s"/>\n                </svg>',w='<svg class="icon" viewbox="0 0 100 100">\n                <use xlink:href="#sun" x="-12" y="-18"/>\n                <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradGray)"/>\n                <use xlink:href="#rainDrizzle" x="25" y="65"/>\n                <use xlink:href="#rainDrizzle" x="40" y="65"/>\n                <use xlink:href="#whiteCloud" x="7" />\n              </svg>',k='<svg class="icon" viewbox="0 0 100 100">\n                <use xlink:href="#sun" x="-12" y="-18"/>\n                <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradGray)"/>\n                <use id="drop1" xlink:href="#rainDrop" x="25" y="65"/>\n                <use id="drop3" xlink:href="#rainDrop" x="45" y="65"/>\n                <use xlink:href="#whiteCloud" x="7" />\n              </svg>',x='<svg class="icon" viewbox="0 0 100 100">\n            <use xlink:href="#grayCloud" x="25" y="10" class="reverse-small-cloud" fill="url(#gradDarkGray)"/>\n            <use id="drop4" xlink:href="#rainDrop" x="15" y="65"/>\n            <use id="drop1" xlink:href="#rainDrop" x="25" y="65"/>\n            <use id="drop2" xlink:href="#rainDrop" x="37" y="65"/>\n            <use id="drop3" xlink:href="#rainDrop" x="50" y="65"/>\n            <use xlink:href="#whiteCloud" x="5" y="-7"/>\n          </svg>',b='<svg class="icon" viewbox="0 0 100 100">\n          <use id="snowFlake1" xlink:href="#snowFlake" x="20" y="55"/>\n          <use id="snowFlake2" xlink:href="#snowFlake" x="35" y="65"/>\n          <use id="snowFlake3" xlink:href="#snowFlake" x="45" y="60"/>\n          <use id="snowFlake4" xlink:href="#snowFlake" x="50" y="65"/>\n          <use id="snowFlake5" xlink:href="#snowFlake" x="63" y="65"/>\n          <use xlink:href="#whiteCloud" x="10" y="-15"/>\n        </svg>',S='<svg class="icon" viewbox="0 0 100 100">\n          <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradDarkGray)" x="0" y="20"/>\n          <use xlink:href="#grayCloud" x="30" y="30" class="reverse-small-cloud" fill="url(#gradGray)"/>\n          <use id="mist" xlink:href="#mist" x="0" y="30"/>\n        </svg>',D='<svg class="icon" viewbox="0 0 100 100">\n                <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradGray)"/>\n                <use xlink:href="#whiteCloud" x="7" />\n              </svg>',E='<svg class="icon" viewbox="0 0 100 100">\n                <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradGray)"/>\n                <use xlink:href="#grayCloud" x="25" y="10" class="reverse-small-cloud" fill="url(#gradDarkGray)"/>\n                <use xlink:href="#whiteCloud" x="7" />\n              </svg>',P={200:v,201:v,202:v,230:v,231:v,232:v,233:v,300:w,301:w,302:k,500:k,501:k,502:x,511:x,520:x,521:x,522:x,600:'<svg class="icon" viewbox="0 0 100 100">\n                <use xlink:href="#sun" x="-12" y="-18"/>\n                <use xlink:href="#grayCloud" class="small-cloud" fill="url(#gradGray)"/>\n                <use id="snowFlake2" xlink:href="#snowFlake" x="30" y="65"/>\n                <use id="snowFlake4" xlink:href="#snowFlake" x="45" y="65"/>\n                <use id="snowFlake5" xlink:href="#snowFlake" x="58" y="65"/>\n                <use xlink:href="#whiteCloud" x="7" />\n              </svg>',601:b,602:b,610:'<svg class="icon" viewbox="0 0 100 100">\n              <use xlink:href="#grayCloud" x="25" y="10" class="reverse-small-cloud" fill="url(#gradDarkGray)"/>\n              <use id="snowFlake1" xlink:href="#snowFlake" x="20" y="55"/>\n              <use id="snowFlake2" xlink:href="#snowFlake" x="35" y="65"/>\n              <use id="snowFlake3" xlink:href="#snowFlake" x="45" y="60"/>\n              <use id="snowFlake4" xlink:href="#snowFlake" x="50" y="65"/>\n              <use id="snowFlake5" xlink:href="#snowFlake" x="63" y="65"/>\n              <use xlink:href="#rainDrizzle" x="15" y="65"/>\n              <use xlink:href="#rainDrizzle" x="25" y="65"/>\n              <use xlink:href="#rainDrizzle" x="35" y="65"/>\n              <use xlink:href="#rainDrizzle" x="45" y="65"/>\n              <use xlink:href="#whiteCloud" x="5" y="-7"/>\n            </svg>',611:b,612:b,621:b,622:b,623:'<svg class="icon wind" viewBox="0 0 100 100" id="wind">\n          <path id="wind1" d="M 8,37 L 35,37"/>\n          <path id="wind2" d="M 2,45 L 45,45 C65,45 64,25 52,25 C47,24 42,30 44,35"/>\n          <path id="wind3" d="M 20,55 L 75,55 C90,53 90,35 80,32 C70,28 60,42 70,48 C80,50 80,40 78,41"/>\n          <path id="wind4" d="M 12,65 L 65,65 C85,68 75,87 65,83 C60,81 60,78 61,76"/>\n          <path id="wind5" d="M 5,75 L 48,75"/>\n        </svg>',700:S,711:S,721:S,731:S,741:S,751:S,800:'<svg class="icon" viewbox="0 0 100 100">\n            <use xlink:href="#sun"/>\n          </svg>',801:D,802:D,803:E,804:E,900:'<svg class="icon" viewbox="0 0 100 100">\n              <use xlink:href="#grayCloud" x="25" y="10" class="reverse-small-cloud" fill="url(#gradDarkGray)"/>\n              <use id="ice4" xlink:href="#icePellet" x="25" y="65"/>\n              <use id="ice1" xlink:href="#icePellet" x="35" y="65"/>\n              <use id="ice2" xlink:href="#icePellet" x="47" y="65"/>\n              <use id="ice3" xlink:href="#icePellet" x="60" y="65"/>\n              <use xlink:href="#whiteCloud" x="5" y="-7"/>\n            </svg>'};function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSettings=null,this.currentPageData=null,this.init()}var t,n,r;return t=e,r=[{key:"convertWeatherData",value:function(e){return{descr:e.weather[0].description,feltTemp:e.feels_like.toFixed(),humidity:e.humidity,temp:e.temp.toFixed(),wind:e.wind_speed}}},{key:"convertSearchData",value:function(e){return{latitude:e.geometry.lat,longitude:e.geometry.lng,countryName:e.components.country||"",city:e.components.city||e.components.town||e.components.county||e.components.village||e.components.state||"",timeZone:e.annotations.timezone}}},{key:"getAverageTemp",value:function(e){var t=e.temp.min;return((e.temp.max+t)/2).toFixed()}},{key:"getDefaultSettings",value:function(){return{language:"EN",tempUnits:"deg"}}},{key:"getDefaultPageData",value:function(){return{location:{latitude:41.716667,longitude:44.783333,countryName:"Georgia",city:"Tbilisi",timeZone:{name:"Asia/Tbilisi"}},pictureURL:"../assets/img/bg.jpg",weather:{current:{temp:10,descr:"overcast",feltTemp:7,wind:2,humidity:83,icon:P[803]},forecast:[{weekDay:"Tuesday",temp:7,icon:P[300]},{weekDay:"Wednesday",temp:10,icon:P[200]},{weekDay:"Thursday",temp:12,icon:P[700]}]}}}},{key:"convertLocationData",value:function(e){return{city:e.city||"",countryName:e.country_name||"",latitude:e.latitude,longitude:e.longitude,timeZone:e.time_zone}}}],(n=[{key:"init",value:function(){this.currentSettings=this.constructor.getDefaultSettings(),this.currentPageData=this.constructor.getDefaultPageData()}},{key:"updateUserLocation",value:function(e,t){this.currentPageData.location=t?this.constructor.convertSearchData(e):this.constructor.convertLocationData(e)}},{key:"changeLang",value:function(e){this.currentSettings.language=e}},{key:"changeTempUnits",value:function(e){this.currentSettings.tempUnits=e}},{key:"updatePicture",value:function(e){this.currentPageData.pictureURL=e}},{key:"updateCurrentWeather",value:function(e){this.currentPageData.weather.current=this.constructor.convertWeatherData(e),this.currentPageData.weather.current.icon=P[e.weather[0].id]}},{key:"updateForecastWeather",value:function(e){var t=this;this.currentPageData.weather.forecast=e.map((function(e){var n=e,r=e.weather[0].id;return n.icon=P[r],n.temp=t.constructor.getAverageTemp(n),n}))}}])&&L(t.prototype,n),r&&L(t,r),e}(),T=n(18);function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.weatherData=new C,this.currentPageData=this.weatherData.currentPageData,this.weatherView=new p(this.currentPageData,this.weatherData.currentSettings),this.init()}var t,n,r;return t=e,r=[{key:"getSeason",value:function(e){var t=(new Date).toLocaleString("en-US",{hour12:!1,timeZone:e.timeZone.name}).replace(/\b24/g,"00"),n=new Date(t).getMonth(),r=Number(e.latitude)<0?"south":"north";switch(n){case 0:case 1:case 11:return"north"===r?"winter":"summer";case 2:case 3:case 4:return"north"===r?"spring":"autumn";case 5:case 6:case 7:return"north"===r?"summer":"winter";case 8:case 9:case 10:return"north"===r?"autumn":"spring";default:return"summer"}}},{key:"getDayPart",value:function(e){var t=(new Date).toLocaleString("en-US",{hour12:!1,timeZone:e.name}).replace(/\b24/g,"00"),n=new Date(t).getHours();return n>=0&&n<6?"night":n>=6&&n<10?"morning":n>=10&&n<18?"day":n>=18&&n<24?"evening":"day"}}],(n=[{key:"init",value:function(){var e=this;this.initialData=this.getInitialData().then((function(t){e.getSettingsFromStorage(),e.updateWeatherView(t),e.bind(),e.setTimer()}))}},{key:"bind",value:function(){var e=this;this.weatherView.onUserSearch=function(t){e.updatePageData(t)},this.weatherView.onBgUpdate=function(){return e.loadPicture("withoutCityKeyword").then((function(t){e.weatherData.currentPageData.pictureElem=t,e.weatherView.constructor.updateBgPicture(t)}))},this.weatherView.onTempUnitsChange=function(t){e.weatherData.changeTempUnits(t),localStorage.settings=JSON.stringify(e.weatherData.currentSettings)},this.weatherView.mapElem.onMapSearch=function(t){e.updatePageData(t.join(","))}}},{key:"getInitialData",value:function(){var e=this;return T.a.getLocationFromIP().then((function(t){return e.getDataFromLocation(t)})).catch((function(t){return e.weatherView.constructor.showErrorMessage(t),"error"}))}},{key:"updatePageData",value:function(e){var t=this;this.getNewSearchData(e).then((function(e){return t.updateWeatherView(e)}))}},{key:"getNewSearchData",value:function(e){var t=this;return T.a.getLocationFromSearch(e).then((function(e){return t.getDataFromLocation(e,"onSearch")})).catch((function(e){return t.weatherView.constructor.showErrorMessage(e),"error"}))}},{key:"getDataFromLocation",value:function(e,t){var n=this;return this.weatherData.updateUserLocation(e,t),this.loadPicture().then((function(e){return n.weatherData.currentPageData.pictureElem=e,T.a.getWeather(n.weatherData.currentPageData.location)})).then((function(e){n.weatherData.updateCurrentWeather(e.current),n.weatherData.updateForecastWeather(e.daily.slice(1,4))}))}},{key:"getSettingsFromStorage",value:function(){localStorage.settings?this.weatherData.currentSettings=JSON.parse(localStorage.getItem("settings")):localStorage.setItem("settings",JSON.stringify(this.weatherData.currentSettings))}},{key:"setTimer",value:function(){var e=this;!function t(){setTimeout((function(){e.weatherView.renderTime(e.weatherData.currentPageData.location.timeZone),t()}),1e3)}()}},{key:"loadPicture",value:function(e){var t=this,n=this.constructor.getSeason(this.weatherData.currentPageData.location),r=this.constructor.getDayPart(this.weatherData.currentPageData.location.timeZone),a=(e?"":this.weatherData.currentPageData.location).city;return T.a.getPicture(n,r,a).then((function(e){return e.urls.error?(t.weatherView.constructor.showErrorMessage(e.urls.error),!1):(t.weatherData.updatePicture(e.urls.regular),T.a.loadPicture(e.urls.regular))}))}},{key:"updateWeatherView",value:function(e){if(!e){var t=this.weatherData.currentPageData,n=this.weatherData.currentSettings;this.weatherView.updatePageOnSearch(t,n),this.weatherView.switchPageTempUnits(this.weatherData.currentSettings.tempUnits)}}}])&&F(t.prototype,n),r&&F(t,r),e}()},102:function(e,t,n){"use strict";n.r(t),function(e){n(103),n(105);var t=new(n(101).a);e.console.log(t)}.call(this,n(38))},103:function(e,t,n){var r=n(54),a=n(104);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1};r(a,i);e.exports=a.locals||{}},104:function(e,t,n){},105:function(e,t,n){var r=n(54),a=n(106);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1};r(a,i);e.exports=a.locals||{}},106:function(e,t,n){},18:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));n(83),n(95),n(136);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a="https://ipinfo.io/json?token=".concat("2a19f789eef429");function i(e){if(e.status>=200&&e.status<300)return e.json();if(403===e.status||401===e.status)throw new Error("Status 401. Try another API key");throw new Error("Server error: ".concat(e.status," ").concat(e.statusText))}var o=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,o,u;return n=t,u=[{key:"getLocationFromIP",value:function(){return fetch(a).then((function(e){return i(e)}))}},{key:"getPicture",value:function(t,n,r){return fetch("https://api.unsplash.com/photos/random?orientation=landscape&per_page=1&query=".concat(t,",").concat(n).concat(r?",".concat(r):"","&client_id=").concat("GQjRk-D9Zie-eJHzZM2An22hwVzHUEnARNRFmy-cKXw")).then((function(a){return e.console.info("Keywords for picture searching: ".concat(t,", ").concat(n).concat(r?", ".concat(r):"")),function(e){if(e.status>=200&&e.status<300)return e.json();if(403===e.status||401===e.status)throw new Error("API key limit for picture exceeded. Standard picture is shown");throw new Error("Server error: ".concat(e.status," ").concat(e.statusText,". ").concat("Standard picture is shown"))}(a)})).catch((function(e){return{urls:{regular:"https://images.unsplash.com/photo-1586521995568-39abaa0c2311?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",error:e}}}))}},{key:"loadPicture",value:function(e){return new Promise((function(t){var n=new Image;n.classList.add("loaded-image"),n.addEventListener("load",(function(){t(n)}),{once:!0}),n.src=e}))}},{key:"getWeather",value:function(e){var t=e.latitude,n=e.longitude,r="".concat("https://api.openweathermap.org/data/2.5/onecall?","lat=").concat(t,"&lon=").concat(n,"&%20exclude=daily&appid=").concat("20a7f0470778661155aef273e4726d39","&units=metric");return fetch(r).then((function(e){return i(e)})).catch((function(e){throw e&&"TypeError: Failed to fetch"!==String(e)?new Error(e):new Error("Openweathermap not responding. Try again later")}))}},{key:"getLocationFromSearch",value:function(e){var t="https://api.opencagedata.com/geocode/v1/json?q=".concat(e,"&key=").concat("9fff6a0c2b4b4d3ea5e108f11cfd5c71","&language=en&pretty=1");return fetch(t).then((function(e){return i(e)})).then((function(e){var t=e.results[0];if(0===e.total_results)throw new Error("Sorry, no results");return t}))}}],(o=null)&&r(n.prototype,o),u&&r(n,u),t}()}).call(this,n(38))}});